language: perl
branches:
  only:
  - master
sudo: required
env:
  global:
    secure: KEdjieBuXIqyVJYMrj0jIlK3YO+GPqI6T56tUwSlIgCy0z7yclW3Unr4Q1XCFYRO9rX6oJoj6HUw+qFLru+mZdTxVDh8mnKpcg9jJ/TZJxl2GViQWv10fufFxDqgm/04xVXhpkYGg9
install:
- cd ~
- git clone https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git komments
- cd komments
- git checkout komments
- git pull origin komments
script:
- cd ${TRAVIS_BUILD_DIR}
- perl ~/komments/kpp.pl documentation.m
- zip very-simple.zip *.m *.html
after_success:
- cd ~
- git clone https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git gh-pages
- cd gh-pages
- git config user.name "Jan Tilly"
- git config user.email "jantilly@gmail.com"
- git checkout gh-pages
- git pull origin gh-pages
- mv ${TRAVIS_BUILD_DIR}/documentation.m.html .
- mv ${TRAVIS_BUILD_DIR}/very-simple.zip .
- git add *.html *.zip
- git commit -m "automatic travis update"
- git push origin gh-pages
notifications:
  email:
    on_success: change
    on_failure: change
